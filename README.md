# Scrapper Application

Добро пожаловать в **Scrapper Application** — современное веб-приложение на базе FastAPI для веб-трекинга полезных ссылок. Приложение использует **Poetry** для управления зависимостями при локальной разработке и **Docker Compose** для запуска контейнеров совместно с необходимыми сервисами (например, PostgreSQL).



## Таблица содержимого

- [Требования](#требования)
- [Установка и запуск](#установка-и-запуск)
  - [Локальная установка (Poetry)](#локальная-установка-poetry)
  - [Запуск через Docker Compose](#запуск-чрез-docker-compose)
- [База данных](#база-данных)
- [Тестирование и разработка](#тестирование-и-разработка)
- [Полезные команды](#полезные-команды)
- [Лицензия](#лицензия)

## Требования

- **Python 3.11+**
- **Poetry** для управления зависимостями при локальной разработке.
- **Docker & Docker Compose** — для запуска приложения и необходимых сервисов (например, PostgreSQL).

## Установка и запуск

### Локальная установка (Poetry)

1. **Клонирование репозитория:**

   ```bash
   git clone https://github.com/yourusername/scrapper-application.git
   cd scrapper-application
   ```

2. **Установка зависимостей:**

   ```bash
   poetry install
   ```

3. **Активация виртуального окружения:**

   ```bash
   poetry shell
   ```

4. **Запуск сервера:**

   ```bash
   uvicorn src.server:app --reload
   ```

### Запуск через Docker Compose

1. Перейдите в корневую директорию проекта.
2. Соберите и запустите контейнеры:

   ```bash
   docker compose down -v && docker compose up --build
   ```

## База данных

Проект использует PostgreSQL, который поднимается через Docker Compose. Ключевые моменты работы с БД:

- **Новые реализации репозиториев:**  
  Есть две реализации репозиториев:
  - **ORM-репозитории** (на основе SQLAlchemy) для объектного подхода.
  - **SQL-репозитории** для прямого взаимодействия с БД посредством SQL-запросов.

- **Изменения в таблице `tags`:**  
  Для обеспечения согласованности и исключения ошибок при запросах поле было изменено:
  - Старое: `name`
  - Новое: `tag_name`
  
  Все обращения к этому полю в репозиториях и DTO теперь используют `tag_name`.

- **Обработка ошибок:**  
  При работе с базой данных выбрасываются специализированные исключения (например, `LinkAddError`), что упрощает обработку ошибок в других модулях приложения.

## Тестирование и разработка

- **Тестирование:**  
  Запускайте тесты с помощью:

  ```bash
  poetry run pytest
  ```

- **Линтинг и форматирование кода:**  
  Проверяйте стиль кода и форматируйте его командами:

  ```bash
  poetry run flake8 .
  poetry run black .
  ```

- **Режим разработки:**  
  При локальной разработке используйте режим hot-reload:

  ```bash
  uvicorn src.server:app --reload
  ```

## Полезные команды

- **Установка зависимостей с помощью Poetry:**

  ```bash
  poetry install
  ```

- **Запуск тестов:**

  ```bash
  poetry run pytest
  ```

- **Запуск линтера:**

  ```bash
  poetry run flake8 .
  ```

- **Форматирование кода:**

  ```bash
  poetry run black .
  ```

- **Запуск через Docker Compose:**
  
  ```bash
  docker compose down -v && docker compose up --build
  ```

